<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sistema Contable Simple con Pronóstico de Demanda</title>
    <style>
        /* Estilos generales */
        body {
            font-family: Arial, sans-serif;
            background-color: #f4f4f9;
            margin: 0;
            padding: 0;
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
        }

        h1, h2 {
            color: #333;
        }

        label {
            font-weight: bold;
        }

        input[type="text"],
        input[type="password"],
        input[type="number"] {
            width: 100%;
            padding: 8px;
            margin: 5px 0 15px 0;
            border: 1px solid #ddd;
            border-radius: 4px;
            box-sizing: border-box;
        }

        button {
            background-color: #4CAF50;
            color: white;
            padding: 10px 20px;
            margin: 10px 0;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 16px;
        }

        button:hover {
            background-color: #45a049;
        }

        p {
            margin: 0 0 10px;
        }

        /* Estilos de cada sección */
        #login-section, #control-stock-section, #transaccion-section, #pronostico-section, #resumen-section {
            border: 1px solid #ddd;
            padding: 20px;
            border-radius: 5px;
            background-color: #fff;
            box-shadow: 0px 0px 5px rgba(0, 0, 0, 0.1);
            margin-bottom: 20px;
        }

        #stock-list {
            margin-top: 20px;
            font-size: 14px;
            color: #333;
        }

        #error-msg, #stock-msg, #transaccion-msg, #pronostico-msg {
            font-weight: bold;
        }

        #error-msg {
            color: red;
        }

        #stock-msg, #transaccion-msg, #pronostico-msg {
            color: #4CAF50;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Sistema Contable Simple</h1>
        
        <!-- Sección de inicio de sesión -->
        <div id="login-section">
            <h2>Iniciar Sesión</h2>
            <label for="usuario">Usuario:</label>
            <input type="text" id="usuario" placeholder="Ingresa tu usuario"><br>
            
            <label for="contraseña">Contraseña:</label>
            <input type="password" id="contraseña" placeholder="Ingresa tu contraseña"><br>
            
            <button onclick="iniciarSesion()">Iniciar Sesión</button>
            <p id="error-msg"></p>
        </div>
        
        <!-- Sección de acciones -->
        <div id="acciones-section" style="display: none;">
            <button onclick="mostrarAgregarTransaccion()">Agregar Transacción</button>
            <button onclick="generarResumen()">Generar Resumen Diario</button>
            <button onclick="mostrarControlStock()">Control de Stock</button>
            <button onclick="mostrarPronostico()">Pronóstico de Demanda</button>
            <button onclick="cerrarSesion()">Salir</button>
        </div>

        <!-- Sección de control de stock -->
        <div id="control-stock-section" style="display: none;">
            <h2>Control de Stock</h2>
            <label for="producto">Producto:</label>
            <input type="text" id="producto" placeholder="Nombre del producto"><br>
            
            <label for="cantidad">Cantidad:</label>
            <input type="number" id="cantidad" placeholder="Cantidad en stock"><br>
            
            <button onclick="actualizarStock()">Actualizar Stock</button>
            <p id="stock-msg"></p>
            
            <!-- Lista de productos en inventario -->
            <div id="stock-list">
                <h2>Inventario de Productos</h2>
                <ul id="lista-productos"></ul>
            </div>
        </div>

        <!-- Sección para agregar transacción -->
        <div id="transaccion-section" style="display: none;">
            <h2>Agregar Transacción</h2>
            <label for="referencia">Referencia del Producto:</label>
            <input type="text" id="referencia" placeholder="Ingresa la referencia"><br>
            
            <label for="valor">Valor de Compra:</label>
            <input type="number" id="valor" placeholder="Ingresa el valor"><br>
            
            <label for="cantidad-vendida">Cantidad Vendida:</label>
            <input type="number" id="cantidad-vendida" placeholder="Cantidad vendida"><br>
            
            <button onclick="agregarTransaccion()">Agregar</button>
            <p id="transaccion-msg"></p>
        </div>

        <!-- Sección de pronóstico de demanda -->
        <div id="pronostico-section" style="display: none;">
            <h2>Pronóstico de Demanda</h2>
            <label for="tipo-pronostico">Selecciona el tipo de pronóstico:</label>
            <select id="tipo-pronostico" onchange="mostrarCamposHistoricos()">
                <option value="">Seleccionar</option>
                <option value="dia">Por día</option>
                <option value="mes">Por mes</option>
                <option value="año">Por año</option>
            </select>
            <div id="valores-historicos" style="display: none; margin-top: 10px;">
                <label for="historial">Ingrese los valores históricos separados por comas:</label>
                <input type="text" id="historial" placeholder="Ejemplo: 20, 30, 25, 28"><br>
                <button onclick="calcularPronostico()">Calcular Pronóstico</button>
                <p id="pronostico-msg"></p>
            </div>
        </div>

        <!-- Sección para el resumen diario -->
        <div id="resumen-section" style="display: none;">
            <h2>Resumen Diario</h2>
            <p id="resumen-total"></p>
            <p id="resumen-promedio"></p>
        </div>
    </div>

    <script>
        // Variables para almacenar el estado de sesión y stock
        let sesionIniciada = false;
        let inventario = {};

        function iniciarSesion() {
            const usuario = document.getElementById("usuario").value;
            const contraseña = document.getElementById("contraseña").value;
            if (usuario === "admin" && contraseña === "1234") {
                sesionIniciada = true;
                document.getElementById("login-section").style.display = "none";
                document.getElementById("acciones-section").style.display = "block";
            } else {
                document.getElementById("error-msg").textContent = "Usuario o contraseña incorrectos.";
            }
        }

        function cerrarSesion() {
            sesionIniciada = false;
            document.getElementById("login-section").style.display = "block";
            document.getElementById("acciones-section").style.display = "none";
        }

        function mostrarControlStock() {
            document.getElementById("control-stock-section").style.display = "block";
        }

        function actualizarStock() {
            const producto = document.getElementById("producto").value;
            const cantidad = parseInt(document.getElementById("cantidad").value);

            if (producto && cantidad > 0) {
                if (inventario[producto]) {
                    inventario[producto] += cantidad;
                } else {
                    inventario[producto] = cantidad;
                }
                document.getElementById("stock-msg").textContent = "Stock actualizado.";
                document.getElementById("producto").value = "";
                document.getElementById("cantidad").value = "";
                actualizarListaProductos();
            } else {
                document.getElementById("stock-msg").textContent = "Por favor ingresa un producto y una cantidad válida.";
            }
        }

        function actualizarListaProductos() {
            const listaProductos = document.getElementById("lista-productos");
            listaProductos.innerHTML = "";

            for (let producto in inventario) {
                const item = document.createElement("li");
                item.textContent = `${producto}: ${inventario[producto]} unidades`;
                listaProductos.appendChild(item);
            }
        }

        function mostrarAgregarTransaccion() {
            document.getElementById("transaccion-section").style.display = "block";
        }

        function agregarTransaccion() {
            const referencia = document.getElementById("referencia").value;
            const valor = parseFloat(document.getElementById("valor").value);
            const cantidadVendida = parseInt(document.getElementById("cantidad-vendida").value);

            if (inventario[referencia] && inventario[referencia] >= cantidadVendida) {
                inventario[referencia] -= cantidadVendida;
                document.getElementById("transaccion-msg").textContent = "Transacción registrada y stock actualizado.";
                document.getElementById("referencia").value = "";
                document.getElementById("valor").value = "";
                document.getElementById("cantidad-vendida").value = "";
                actualizarListaProductos();
            } else {
                document.getElementById("transaccion-msg").textContent = "Stock insuficiente o producto no encontrado.";
            }
        }

        function mostrarPronostico() {
            document.getElementById("pronostico-section").style.display = "block";
        }

        function mostrarCamposHistoricos() {
            const tipo = document.getElementById("tipo-pronostico").value;
            document.getElementById("valores-historicos").style.display = tipo ? "block" : "none";
        }

        function calcularPronostico() {
            const historial = document.getElementById("historial").value.split(",").map(Number);
            if (historial.length < 2 || historial.includes(NaN)) {
                document.getElementById("pronostico-msg").textContent = "Por favor, ingrese al menos dos valores numéricos válidos.";
                return;
            }

            // Implementación de regresión lineal simple
            const n = historial.length;
            const x = Array.from({length: n}, (_, i) => i + 1);
            const sumX = x.reduce((a, b) => a + b, 0);
            const sumY = historial.reduce((a, b) => a + b, 0);
            const sumXY = x.reduce((sum, xi, i) => sum + xi * historial[i], 0);
            const sumX2 = x.reduce((sum, xi) => sum + xi * xi, 0);
            
            const slope = (n * sumXY - sumX * sumY) / (n * sumX2 - sumX * sumX);
            const intercept = (sumY - slope * sumX) / n;

            const pronostico = slope * (n + 1) + intercept;
            document.getElementById("pronostico-msg").textContent = `Pronóstico para el próximo período: ${pronostico.toFixed(2)}`;
        }

        function generarResumen() {
            let totalVentas = 0;
            let totalProductos = 0;

            for (let producto in inventario) {
                totalProductos += inventario[producto];
                totalVentas += inventario[producto] * 10;  // Valor ficticio para ejemplo
            }

            document.getElementById("resumen-total").textContent = `Total de productos en stock: ${totalProductos}`;
            document.getElementById("resumen-promedio").textContent = `Valor promedio por producto: $${(totalVentas / totalProductos).toFixed(2)}`;
            document.getElementById("resumen-section").style.display = "block";
        }
    </script>
</body>
</html>
